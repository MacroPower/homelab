apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: twitch-predictions-init-scripts-tpl

spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: default

  data:
    - secretKey: TWITCH_PREDICTIONS_DB_PASS
      remoteRef:
        key: TWITCH_PREDICTIONS_DB_PASS

    - secretKey: POSTGRES_DB_PASS
      remoteRef:
        key: PATRONI_SUPERUSER_PASSWORD

  target:
    name: twitch-predictions-init-scripts
    template:
      engineVersion: v2

      templateFrom:
        - configMap:
            name: twitch-predictions-init-scripts-tpl
            items:
              - key: twitch_predictions_db_init.sh
