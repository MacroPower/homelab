apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: grafana-cloud-datasources-tpl

spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: default

  dataFrom:
    - find:
        path: GRAFANA_CLOUD_

  target:
    name: grafana-cloud-datasources
    template:
      engineVersion: v2

      metadata:
        labels:
          grafana_datasource: '1'

      templateFrom:
        - configMap:
            name: grafana-cloud-datasources-tpl
            items:
              - key: config.yaml
