apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: timescale

helmCharts:
  - name: pgadmin4
    repo: https://helm.runix.net
    version: 1.13.1
    releaseName: pgadmin4
    namespace: timescale
    valuesInline:
      serviceAccount:
        create: true

      serverDefinitions:
        enabled: false

      env:
        email: admin@example.com
        password: admin

        variables:
          - name: PGADMIN_SERVER_JSON_FILE
            value: /pgadmin4/servers.json

      extraConfigmapMounts:
        - name: pg-servers
          mountPath: /pgadmin4/servers.json
          subPath: servers.json
          configMap: pg-servers
          readOnly: true

      persistentVolume:
        enabled: false

resources:
  - servers.yaml
