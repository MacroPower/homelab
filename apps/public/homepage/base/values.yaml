# yaml-language-server: $schema=../../../../charts/homepage/values.schema.json

controllers:
  app:
    replicas: 1
    strategy: RollingUpdate
    annotations:
      reloader.stakater.com/auto: "true"
    containers:
      app:
        image:
          repository: ghcr.io/gethomepage/homepage
          tag: v1.5.0
        env:
          LOG_TARGETS: { value: "stdout" }
        resources:
          requests:
            memory: 10Mi
            cpu: 10m
          limits:
            memory: 200Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop: ["ALL"]
            # Required for prerender cache.
            add:
              - CHOWN
              - FOWNER
              - DAC_OVERRIDE
        probes:
          startup:
            enabled: true
            spec:
              failureThreshold: 30
              periodSeconds: 5
          liveness:
            enabled: true
          readiness:
            enabled: true

serviceAccount:
  homepage: {}

persistence:
  config-dir:
    type: emptyDir
    globalMounts:
      - path: /app/config
  config-files:
    type: configMap
    name: homepage-config
    globalMounts:
      - subPath: kubernetes.yaml
        path: /app/config/kubernetes.yaml
      - subPath: settings.yaml
        path: /app/config/settings.yaml
      - subPath: bookmarks.yaml
        path: /app/config/bookmarks.yaml
      - subPath: services.yaml
        path: /app/config/services.yaml
      - subPath: widgets.yaml
        path: /app/config/widgets.yaml
  logs:
    type: emptyDir
    globalMounts:
      - path: /app/config/logs
