{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "config:recommended",
    ":disableRateLimiting",
    ":separateMultipleMajorReleases",
    ":automergePatch",
  ],
  customManagers: [
    {
      customType: "regex",
      fileMatch: ["(^|/)charts/charts\\.k$"],
      matchStrings: [
        ".*\\{(\\n.*?)*[^\\}]*",
        '(.*\\n)*\\s*chart\\s*=\\s*"(?<depName>.+)"(.*\\n)*\\s*repoURL\\s*=\\s*"(?<registryUrl>https:\\/\\/.+)"(.*\\n)*\\s*targetRevision\\s*=\\s*"(?<currentValue>.+)"',
      ],
      matchStringsStrategy: "recursive",
      datasourceTemplate: "helm",
    },
    {
      customType: "regex",
      fileMatch: ["(^|/)charts/charts\\.k$"],
      matchStrings: [
        ".*\\{(\\n.*?)*[^\\}]*",
        '(.*\\n)*\\s*chart\\s*=\\s*"(?<depName>.+)"(.*\\n)*\\s*repoURL\\s*=\\s*"oci:\\/\\/(?<packageName>.+)"(.*\\n)*\\s*targetRevision\\s*=\\s*"(?<currentValue>.+)"',
      ],
      matchStringsStrategy: "recursive",
      datasourceTemplate: "docker",
    },
  ],
  packageRules: [
    {
      matchManagers: ["custom.regex"],
      postUpgradeTasks: {
        commands: ['kcl chart update -q --chart="{{depName}}" --path="{{packageFileDir}}"'],
        executionMode: "update",
      },
    },
  ],
}
